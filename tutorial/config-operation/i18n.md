---
description: 此為 v0.0.8 後的功能。
---

# 多語言文件\[NEW\]

多語言文件，指一個訊息集合下可有多種不同的語言，可用作 [i18n](https://openhome.cc/Gossip/Rails/i18n.html)。

假設你的插件 jar 內有兩種語言文件:

{% code title="Langs/en-us.yml" %}
```yaml
prefix: "[ELD] "
first: "This is the first message"
second: "This is the second message"
third: "This is the third message"
```
{% endcode %}

{% code title="Langs/zh-tw.yml" %}
```yaml
prefix: "[ELD] "
first: "這是第一則信息"
second: "這是第二則訊息"
third: "這是第三則信息"
```
{% endcode %}

則創建一個繼承 `GroupLangConfiguration` 的類，並配置如下:

```java
@Prefix(path = "prefix") // 定義prefix
@GroupResource(
        folder = "Langs", // 語言文件的文件夾
        preloads = {"en-us", "zh-tw"} // 複製這兩個文件從 jar 內到 插件資料夾
)
public class TesterMultiLang extends GroupLangConfiguration {
}

```

註冊如下:

```java
@ELDPlugin(
        registry = TesterRegistry.class,
        lifeCycle = TesterLifeCycle.class
)
public class ELDTester extends ELDBukkitPlugin {

    @Override
    protected void bindServices(ServiceCollection serviceCollection) {
        serviceCollection.addMultipleLanguages(TesterMultiLang.class); // 註冊多語言文件
    }

    @Override
    protected void manageProvider(ManagerProvider provider) {

    }
}
```

## 使用

註冊完成後，則可注入 `Map<String, TesterMultiLang>` 類別來進行獲取:

```java
@Commander(
        name = "lang",
        description = "test language command"
)
public class TestLanguageCommand implements CommandNode {


    @Inject
    private Map<String, TesterMultiLang> multiLangMap;

    @CommandArg(order = 1)
    private String language;

    @Override
    public void execute(CommandSender commandSender) {
        TesterMultiLang multiLang = multiLangMap.get(language);
        if (multiLang == null){
            commandSender.sendMessage("unknown language");
        }else{
            commandSender.sendMessage(multiLang.getLang().get("first"));
            commandSender.sendMessage(multiLang.getLang().get("second"));
            commandSender.sendMessage(multiLang.getLang().get("third"));
        }
    }
}
```

{% hint style="success" %}
在上述的指令中, 輸入 /test lang en-us 將出現 en-us.yml 文件內的訊息，輸入 /test lang zh-tw 則出現 zh-tw.yml 文件內的訊息。若查無文件，則發送 `unknown language 。`
{% endhint %}

## 使用為 i18n 

你可以透過多語言文件實作 i18n 的服務，範例如下:

{% code title="I18nService.java" %}
```java
public interface I18nService {
    
    void sendMessage(Player player, String path);
    
    void switchLanguage(Player player, String lang);
    
}
```
{% endcode %}

{% code title="I18nServiceImpl.java" %}
```java
public class I18nServiceImpl implements I18nService{

    private final Map<UUID, String> languageMap = new HashMap<>(); // 語言儲存資料庫，你應實作離線儲存

    @Inject
    private Map<String, TesterMultiLang> multiLangMap;

    // 根據玩家的語言發送訊息
    @Override
    public void sendMessage(Player player, String path) {
        String lang = languageMap.getOrDefault(player.getUniqueId(), "en-us");
        TesterMultiLang langConfig = multiLangMap.get(lang);
        if (langConfig == null){
            player.sendMessage("由於沒有你的語言 (".concat(lang).concat("), 因此使用回默認語言 en-us"));
            langConfig = multiLangMap.get("en-us");
        }
        player.sendMessage(langConfig.getLang().get(path)); // 發送玩家所使用的語言的訊息
    }

    // 切換語言
    @Override
    public void switchLanguage(Player player, String lang) {
        languageMap.put(player.getUniqueId(), lang);
    }
}
```
{% endcode %}

{% hint style="info" %}
記得別忘了註冊！
{% endhint %}

